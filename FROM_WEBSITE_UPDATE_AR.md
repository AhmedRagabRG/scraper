# ملخص التحديث: إضافة حقل from_website

## التاريخ: 2026-01-23

## ✅ التغييرات المنفذة

### 1. تعديل ملف `scraper.py`
- ✅ إضافة حقل `from_website: False` في البيانات الأولية
- ✅ تعيين `from_website = True` عند استخراج الإيميل من الموقع
- ✅ تعيين `from_website = False` عند استخراج الإيميل من Google Maps

### 2. تعديل ملف `api.py`
- ✅ إضافة `from_website` في ترتيب أعمدة CSV (بين `email` و `website`)

### 3. ملفات جديدة
- ✅ `FROM_WEBSITE_FEATURE.md` - توثيق شامل للميزة
- ✅ `test_from_website.py` - سكريبت اختبار
- ✅ `FROM_WEBSITE_UPDATE_AR.md` - هذا الملف

## 📊 كيف يعمل

```
┌─────────────────────────────────────┐
│  هل يوجد موقع للشركة؟              │
└────────────┬────────────────────────┘
             │
        ┌────▼────┐
        │   نعم   │
        └────┬────┘
             │
    ┌────────▼─────────────────────────┐
    │  زيارة الموقع واستخراج الإيميل  │
    └────────┬─────────────────────────┘
             │
        ┌────▼────────┐
        │ وُجد إيميل؟ │
        └────┬────┬───┘
             │    │
        نعم  │    │  لا
             │    │
    ┌────────▼─┐  │
    │from_website│  │
    │   = true   │  │
    └────────────┘  │
                    │
           ┌────────▼──────────────────────┐
           │ البحث في Google Maps          │
           └────────┬──────────────────────┘
                    │
               ┌────▼────────┐
               │ وُجد إيميل؟ │
               └────┬────┬───┘
                    │    │
               نعم  │    │  لا
                    │    │
           ┌────────▼─┐  │
           │from_website│  │
           │  = false   │  │
           └────────────┘  │
                           │
                  ┌────────▼─────┐
                  │ لا يوجد إيميل│
                  │from_website  │
                  │   = false    │
                  └──────────────┘
```

## 🔍 مثال على البيانات

### في CSV:
```csv
business_name,email,from_website,website
مطعم الأمل,info@alamal.com,true,https://alamal.com
مقهى النيل,nile@gmail.com,false,
كافيه الورد,,false,https://alward.com
```

### في Webhook:
```json
{
  "result": {
    "business_name": "مطعم الأمل",
    "email": "info@alamal.com",
    "from_website": true,
    "website": "https://alamal.com"
  }
}
```

## 🧪 الاختبار

لاختبار الميزة الجديدة:

```bash
python test_from_website.py
```

هذا سيقوم بـ:
1. استخراج 3 نتائج من Google Maps
2. عرض الإيميلات ومصادرها
3. حفظ النتائج في `test_from_website_output.json`

## 📝 ملاحظات مهمة

1. **القيمة الافتراضية**: `from_website = False` دائماً في البداية
2. **تغيير القيمة**: تتغير إلى `true` فقط عند العثور على إيميل في الموقع
3. **لا يوجد إيميل**: إذا لم يُعثر على إيميل، يبقى `from_website = False`
4. **الموثوقية**: الإيميلات من المواقع (`from_website = true`) عادة أكثر موثوقية

## 🎯 الفوائد

1. ✅ **شفافية البيانات**: معرفة مصدر كل إيميل
2. ✅ **جودة البيانات**: تمييز الإيميلات الموثوقة
3. ✅ **التحليل**: إحصائيات عن مصادر الإيميلات
4. ✅ **التصفية**: إمكانية تصفية النتائج حسب المصدر

## 🚀 الاستخدام الفوري

الميزة جاهزة للاستخدام فوراً! لا حاجة لأي تغييرات إضافية.

### مثال API:
```bash
curl -X POST "http://localhost:8000/scrape" \
  -H "Content-Type: application/json" \
  -d '{
    "query": "مطاعم في القاهرة",
    "max_results": 10,
    "webhook_url": "https://your-webhook.com/endpoint"
  }'
```

سيتم إرسال `from_website` تلقائياً مع كل نتيجة في الـ webhook!
